<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./style.css">
    <title>cancas-demo</title>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="actions" class="actions">
        <button id="eraser">橡皮擦</button>
        <button id="brush">画笔</button>
        <button id="red">red</button>
    </div>
    
    <script>
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
        var using = false
        var lastPoint = {
            x: undefined,
            y: undefined
        }

        //设置宽高
        autoSetCanvasSize(canvas)
        
        //监听鼠标
        listenToMouse(canvas)
        
        //监听橡皮
        var eraserEnable = false
        eraser.onclick = function(){
            eraserEnable = true
            actions.className = 'actions x'
        }
        brush.onclick = function(){
            eraserEnable = false
            actions.className = 'actions'
        }
        
        
        /*-----------------函数----------------*/
        function listenToMouse(canvas){
            //画一个圆
            function drawCircle(x, y, radius){
                context.beginPath()
                context.arc(x, y, radius, 0, Math.PI*2)
                context.fill()
    
            }
    
            //画一根线
            function drawLine(x1, y1, x2, y2){
                context.beginPath()
                context.strokeStyle = 'black'
                context.moveTo(x1, y1)
                context.lineWidth = 3
                context.lineTo(x2, y2)
                context.stroke()
                context.closePath()
            }
    
            //按下鼠标
            canvas.onmousedown = function(down){        
                var x = down.clientX
                var y = down.clientY
                using = true;
                if(eraserEnable){
                    context.clearRect(x-4, y-4, 8, 8)
                }else{
                    //所得到的x,y是相对于窗口的，但是画的时候是相对于canvas的
                    lastPoint = {x:x,y:y}
                }
            }
            
            //移动鼠标
            canvas.onmousemove = function(move){
                var x = move.clientX
                var y = move.clientY
                if(!using){return}
                if(eraserEnable){
                        context.clearRect(x-4, y-4, 8, 8)
                }else{
                        var newPoint = {x: x,y: y}
                        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
                        //更新最后一个点
                        lastPoint = newPoint
                    }
                }

            //松开鼠标
            canvas.onmouseup = function(up){
                using = false
            }
        }
        function autoSetCanvasSize(canvas){
            setCanvasSize()
            window.onresize = function(){
                setCanvasSize()
            }

            function setCanvasSize(){
            var pageWidth = document.documentElement.clientWidth
            var pageHeight = document.documentElement.clientHeight
            canvas.width = pageWidth
            canvas.height = pageHeight
            }
        }
        
    </script>
</body>
</html>
<!-- 土办法 失败 -->
<!-- <div id="canvas"></div>
<script>
    var canvasDiv = document.getElementById('canvas')
    var painting = false
    //按下鼠标  
    canvasDiv.onmousedown = function(down){
        painting = true
        var x = down.clientX
        var y = down.clientY
        var downDiv = document.createElement('div')
        downDiv.className = 'downDiv'
        canvasDiv.appendChild(downDiv)
        downDiv.style = 'left: '+(x-3) +'px;' + 'top: '+(y-3) +'px;'
    }
    //移动鼠标
    canvasDiv.onmousemove = function(move){
        if(painting){
            var x = move.clientX
            var y = move.clientY
            var moveDiv = document.createElement('div')
            moveDiv.className = 'moveDiv'
            canvasDiv.appendChild(moveDiv)
            moveDiv.style = 'left: '+(x-3) +'px;' + 'top: '+(y-3) +'px;'
        }
    }
    //松开鼠标
    canvasDiv.onmouseup = function(up){
        painting = false

    }
------------------CSS------------------
    #canvas{

background:#687F8C;
height: 100vh;
position: relative;
}   

    .downDiv{
    width: 6px;
    height: 6px;
    background: black;
    border-radius: 3px;
    position: absolute;
}

.moveDiv{
    width: 6px;
    height: 6px;
    background: black;
    border-radius: 3px;
    position: absolute;
}
</script> -->